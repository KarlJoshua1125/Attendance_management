<!DOCTYPE html>
<html lang="en-US" dir="ltr">

<head>
    <title>Students List</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" crossorigin="anonymous"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
          integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous"/>
    <script src="https://kit.fontawesome.com/c326dfdc36.js" crossorigin="anonymous"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js">
    </script>

    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-database.js"></script>
    {% load static %}
    <script type="text/javascript" src="{% static '/js/firebaseConfig.js' %}"></script>
    <script type="text/javascript" src="{% static '/js/date.js' %}"></script>
    <script type="text/javascript" src="{% static '/js/index.js' %}"></script>
    <link rel="stylesheet" href="{% static '/css/index.css' %}">
</head>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const sidebarToggle = document.getElementById("sidebar-toggle");
        const studentsLink = document.getElementById("students-link");
        const attendanceLink = document.getElementById("attendance-link");
        const sectionLink = document.getElementById("section-link");
        ;

        // Hide attendance and students sections by default
        studentsLink.classList.add("d-none");
        attendanceLink.classList.add("d-none");
        sectionLink.classList.add("d-none");


        // Event listener for sidebar toggle button
        sidebarToggle.addEventListener("click", function () {
            // Toggle the visibility of students and attendance sections
            studentsLink.classList.toggle("d-none");
            attendanceLink.classList.toggle("d-none");
            sectionLink.classList.toggle("d-none");

        });
    });
</script>

<body>
    <div class="container-fluid">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <button class="btn btn-link" id="sidebar-toggle" aria-label="Toggle Sidebar">
                <i class="fas fa-bars fa-lg"></i>
            </button>
            
            <div class="container">
                
                <a class="navbar-brand" href="#">Attendance Monitoring System</a>
                
                <div class="ml-auto">
                    <form class="form-inline">
                        <div class="input-group">
                            <input type="text" class="form-control" id="search-input" placeholder="Search by Last Name">
                            <div class="input-group-append">
                                <button class="btn btn-outline-secondary" type="button">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </nav>
        <div class="row">
            <div class="col-sm-auto bg-light sticky-top">
                <div class="d-flex flex-sm-column flex-row flex-nowrap bg-light align-items-center sticky-top">  
                    <ul class="nav nav-pills nav-flush flex-sm-column flex-row flex-nowrap mb-auto mx-auto text-center align-items-center">
                        <li class="nav-item">
                            <a href="{% url 'index' %}" class="nav-link py-3 px-2" title="" data-bs-toggle="tooltip"
                                data-bs-placement="right" data-bs-original-title="Students" id="students-link">
                                <i class="fas fa-users fa-lg"></i>
                                <p>Students</p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'attendance' %}" class="nav-link py-3 px-2" title="" data-bs-toggle="tooltip"
                                data-bs-placement="right" data-bs-original-title="Attendance" id="attendance-link">
                                <i class="fas fa-calendar-alt fa-lg"></i>
                                <p>Attendance</p>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'sections' %}" class="nav-link py-3 px-2" title="" data-bs-toggle="tooltip"
                                data-bs-placement="right" data-bs-original-title="Sections" id="section-link">
                                <i class="fa-solid fa-school"></i>
                                <p>Sections</p>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="col-sm p-3 min-vh-100">
                
                <!-- content -->
                <div class="row mb-5">
                     <h2>Students List</h2>
                    <div class="col-sm-8">
                       
                    </div>
                    <div class="col-sm-3" style="margin-top: 40px;">
                        <div class="d-flex flex-row justify-content-end">
                            <button type="button" class="btn btn-success btn-sm mr-2" id="add-student-btn" style="height: 35px;">
                                <i class="fas fa-plus"></i> Add Student
                            </button>
                            <button class="btn btn-secondary btn-sm mr-2" id="sort-button" style="height: 35px;">
                                <i class="fas fa-sort"></i> Sort by Last Name
                            </button>
                        </div>
                    </div>                       
                </div>
                
                    
                    <table class="table table-striped" id="students-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>First Name</th>
                                <th>Last Name</th>
                               
                                <th>Year</th>
                                <th>Course</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for student in students %}
                            <tr>
                                <td class="id">{{ student.id }}</td>
                                <td class="fname">{{ student.fname }}</td>
                                <td class="lname">{{ student.lname }}</td>
                                
                                <td class="year">{{ student.year }}</td>
                                <td class="course">{{ student.course }}</td>
                                <td>
                                    <a href="#" class="edit-student btn btn-primary" data-key="{{ student.key }}"
                                        data-bs-toggle="modal" data-bs-target="#update-student-modal">
                                        <i class="fas fa-edit"></i>
                                    </a>
                    
                                    <a class="btn btn-danger" href='deletestudent/{{ student.id }}'>
                                        <i class="fas fa-trash-alt"></i>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
    
                    <!-- Add Student Modal -->
                    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Add New Student</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <form id="add-student">
                                        <div class="form-group row">
                                            <label for="id">Id</label>
                                            <input type="number" class="form-control" name="id" id="id" required>
                                        </div>
                                        <div class="form-group row">
                                            <label for="fname">FirstName</label>
                                            <input type="text" class="form-control" name="fname" id="fname" required>
                                        </div>
                                        <div class="form-group row">
                                            <label for="lname">Last Name</label>
                                            <input type="text" class="form-control" name="lname" id="lname" required>
                                        </div>
                                        <div class="form-group row">
                                            <label for="year">Year</label>
                                            <input type="number" class="form-control" name="year" id="year" required>
                                        </div>
                                        <div class="form-group row">
                                            <label for="course">Course</label>
                                            <input type="text" class="form-control" name="course" id="course" required>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Submit</button>
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
    
                    <!-- Update Student Modal -->
                    <div class="modal fade" id="update-student-modal" tabindex="-1"
                        aria-labelledby="update-student-modal-label" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <form id="update-student-form">
                                    {% csrf_token %}
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="update-student-modal-label">Update Student</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="mb-3">
                                            <label for="update-id" class="form-label">Id</label>
                                            <input type="number" class="form-control" name="id" id="update-id" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="update-fname" class="form-label">First Name</label>
                                            <input type="text" class="form-control" name="fname" id="update-fname" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="update-lname" class="form-label">Last Name</label>
                                            <input type="text" class="form-control" name="lname" id="update-lname" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="update-year" class="form-label">Year</label>
                                            <input type="number" class="form-control" name="year" id="update-year" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="update-course" class="form-label">Course</label>
                                            <input type="text" class="form-control" name="course" id="update-course" required>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" class="btn btn-primary">Save changes</button>
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        <input type="hidden" id="update-student-key">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>    
</body>
</html>

